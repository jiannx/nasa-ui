{"version":3,"sources":["../../components/RangePickerEx/RangePickerEx.jsx"],"names":["React","Component","_","moment","DatePicker","RangePicker","RangePickerEx","props","setDisabledDate","node","className","match","range","isArray","str","title","replace","end","add","start","subtract","setState","disabledDate","endValue","res","valueOf","handleClick","e","console","info","target","parentNode","onOpenChange","status","state","nextProps","id","Math","random","style","document","getElementById","defaultProps"],"mappings":"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","file":"RangePickerEx.js","sourcesContent":["/* 时间跨度选择控件，在antd RangePicker基础上添加 可选时间跨度功能\r\n\r\n<RangePickerEx range={3}/>\r\n<RangePickerEx \r\n  range={[1, 5]}  \r\n  disabledDate={(endValue) => {\r\n    return endValue.valueOf() >= moment().valueOf();\r\n}}/>\r\n */\r\n\r\nimport React, { Component } from 'react';\r\nimport _ from 'lodash';\r\nimport moment from 'moment';\r\nimport { DatePicker } from 'antd';\r\n\r\nconst { RangePicker } = DatePicker;\r\n\r\nclass RangePickerEx extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      disabledDate: props.disabledDate\r\n    };\r\n  }\r\n\r\n  static defaultProps = {\r\n    disabledDate: null,\r\n    range: null, // 时间跨度 默认天 number or array\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {}\r\n\r\n  componentWillMount() {\r\n    this.id = `nasa-rangepicker-${Math.random()}`;\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n  }\r\n\r\n  componentWillUnmount() {}\r\n\r\n  setDisabledDate = (node) => {\r\n    if (node.className.match(/disabled/)) {\r\n      return;\r\n    }\r\n    let range = [];\r\n    if (_.isArray(this.props.range)) {\r\n      range = this.props.range;\r\n    } else {\r\n      range = [this.props.range, this.props.range];\r\n    }\r\n\r\n    let str = node.title;\r\n    str = str.replace(/年|月/g, '-');\r\n    str = str.replace(/日/g, '');\r\n    let end = moment(str).add(range[1] + 1, 'days');\r\n    let start = moment(str).subtract(range[0], 'days');\r\n\r\n    this.setState({\r\n      disabledDate: (endValue) => {\r\n        const res = endValue.valueOf() >= end.valueOf() || endValue.valueOf() <= start.valueOf();\r\n        if (this.props.disabledDate) {\r\n          return res || this.props.disabledDate(endValue);\r\n        }\r\n        return res;\r\n      }\r\n    })\r\n  }\r\n\r\n  handleClick = (e) => {\r\n    if (!this.props.range || this.props.range === '') {\r\n      console.info('RangePicker Ex: range must be number or array');\r\n      return;\r\n    }\r\n    if (e.target && e.target.className.match(/ant-calendar-cell/)) {\r\n      this.setDisabledDate(e.target);\r\n    } else if (e.target.parentNode && e.target.parentNode.className.match(/ant-calendar-cell/)) {\r\n      this.setDisabledDate(e.target.parentNode);\r\n    }\r\n  }\r\n\r\n  onOpenChange = (status) => {\r\n    this.setState({\r\n      disabledDate: this.props.disabledDate\r\n    });\r\n    this.props.onOpenChange && this.props.onOpenChange(status);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <span id={this.id} onClick={this.handleClick} style={this.props.style} className={this.props.className}>\r\n        <RangePicker\r\n          {...this.props}\r\n          onOpenChange={this.onOpenChange}\r\n          getCalendarContainer={() => document.getElementById(this.id)}\r\n          disabledDate={this.state.disabledDate}\r\n        />\r\n      </span>\r\n    )\r\n  }\r\n}\r\n\r\nexport default RangePickerEx;"]}