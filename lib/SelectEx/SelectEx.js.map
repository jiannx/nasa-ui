{"version":3,"sources":["../../components/SelectEx/SelectEx.jsx"],"names":["React","Component","_","Select","Option","SelectEx","props","label","getShowValue","value","state","nextProps","setState","onChange","options","map","bind","x","addonAfter","defaultProps","undefined","item","find","parseInt","setLabel","console","log","OptionEx"],"mappings":"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","file":"SelectEx.js","sourcesContent":["/**\r\n * 支持对象绑定\r\n */\r\nimport React, { Component } from 'react';\r\nimport _ from 'lodash';\r\nimport { Select } from 'antd';\r\nconst Option = Select.Option;\r\n\r\nexport default class SelectEx extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    let label = this.getShowValue(props.value, props);\r\n    this.state = {\r\n      value: label,\r\n    };\r\n  }\r\n\r\n  static defaultProps = {\r\n    options: [],\r\n    bind: null, //  用于绑定的字段, 如果为空，则返回选中的对象\r\n    label: null, // 用于显示的字段 必须唯一\r\n    addonAfter: null\r\n  }\r\n\r\n  getShowValue = (value, props) => {\r\n    if (value === null || value === undefined) {\r\n      return undefined;\r\n    }\r\n    let item = null;\r\n    let label = ' ';\r\n    if (props.bind) {\r\n      item = props.options.find(x => x[props.bind] === value || x[props.bind] === parseInt(value, 10));\r\n      label = item ? item[props.label] : null;\r\n    } else if (props.label) {\r\n      item = props.options.find(x => x[props.label] === value[props.label]);\r\n      label = item ? item[props.label] : null;\r\n    } else {\r\n      item = props.options.find(x => x === value);\r\n      label = item;\r\n    }\r\n    return label;\r\n  }\r\n\r\n  setLabel = (value) => {\r\n    let label = this.getShowValue(value, this.props);\r\n    this.setState({\r\n      value: label\r\n    });\r\n  }\r\n\r\n  componentWillReceiveProps(nextProps) {\r\n    if (nextProps.value) {\r\n      let label = this.getShowValue(nextProps.value, nextProps);\r\n      this.setState({\r\n        value: label\r\n      });\r\n    } else {\r\n      this.state = {\r\n        value: null,\r\n      };\r\n    }\r\n  }\r\n\r\n  componentDidMount() {}\r\n\r\n  onChange = (value) => {\r\n    console.log('SelectEx select value = ' + value);\r\n\r\n    let item = null;\r\n    if (this.props.bind) {\r\n      item = this.props.options.find(x => x[this.props.bind] === value || x[this.props.bind] === parseInt(value, 10));\r\n    } else if (this.props.label) {\r\n      item = this.props.options.find(x => x[this.props.label] === value || x[this.props.label] === parseInt(value, 10));\r\n    } else {\r\n      item = this.props.options.find(x => x === value || x === parseInt(value, 10));\r\n    }\r\n\r\n    if (this.props.bind) {\r\n      this.setLabel(item[this.props.bind] || value);\r\n    } else {\r\n      this.setLabel(item || value);\r\n    }\r\n    if (this.props.onChange) {\r\n      if (this.props.bind) {\r\n        this.props.onChange(item[this.props.bind] || value);\r\n      } else {\r\n        this.props.onChange(item || value);\r\n      }\r\n    }\r\n  }\r\n\r\n  render() {\r\n    // console.log('selectex');\r\n    // console.log(this.state.value);\r\n    return (\r\n      <Select {...this.props} onChange={this.onChange} value={this.state.value}>\r\n        { this.props.options.map( x => {\r\n          if(this.props.bind){\r\n            return <Option key={x[this.props.bind]} value={x[this.props.bind]}>{x[this.props.label]}</Option>\r\n          } else if(this.props.label){\r\n            return <Option key={x[this.props.label]}>{x[this.props.label]}</Option>\r\n          } else {\r\n            return <Option key={x}>{x}</Option>\r\n          }\r\n        })}\r\n        {this.props.addonAfter}\r\n      </Select>\r\n    )\r\n  }\r\n}\r\n\r\nSelectEx.OptionEx = Option;"]}